<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory IICF_List_List (Isabelle2019: June 2019)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory IICF_List_List</h1>

<span class="command">theory</span> <span class="name">IICF_List_List</span><br/>
<span class="keyword">imports</span> <a href="Sepref.html"><span class="name">Sepref</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">theory</span></span><span> </span><span>IICF_List_List</span><span>
</span><span class="keyword2"><span class="keyword">imports</span></span><span> 
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;../../Sepref&quot;</span></span></span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">context</span></span><span> </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">private</span></span><span> </span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span class="delimiter">(</span><span>input</span><span class="delimiter">)</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;LR A &#8801; &#10216;&#10216;A&#10217;list_rel&#10217;list_rel&quot;</span></span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_lempty</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;n. replicate n []&quot;</span></span></span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat_rel &#8594; LR A&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_push_back</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;xss i x. xss[i:=xss!i@[x]]&quot;</span></span></span><span> 
</span><span>      </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#955;((xss,i),_). i&lt;length xss]<span class="hidden">&#8681;</span><sub>f</sub> (LR A &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel) &#215;<span class="hidden">&#8681;</span><sub>r</sub> A &#8594; LR A&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_pop_back</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;xss i. (last (xss!i), xss[i:=butlast (xss!i)])&quot;</span></span></span><span> 
</span><span>      </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#955;(xss,i). i&lt;length xss &#8743; xss!i&#8800;[]]<span class="hidden">&#8681;</span><sub>f</sub> (LR A &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel)&#8594; A &#215;<span class="hidden">&#8681;</span><sub>r</sub> LR A&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>conv_to_is_Nil</span><span> </span><span>short_circuit_conv</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>parametricity</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_upd</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;xss i j x. xss[i:=(xss!i)[j:=x]]&quot;</span></span></span><span> 
</span><span>      </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#955;(((xss,i),j),x). i&lt;length xss &#8743; j&lt;length (xss!i)]<span class="hidden">&#8681;</span><sub>f</sub> (((LR A &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel) &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel) &#215;<span class="hidden">&#8681;</span><sub>r</sub> A) &#8594; LR A&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>short_circuit_conv</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>parametricity</span><span>
</span><span>      
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_idx</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;xss i j. xss!i!j&quot;</span></span></span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#955;((xss,i),j). i&lt;length xss &#8743; j&lt;length (xss!i)]<span class="hidden">&#8681;</span><sub>f</sub> ((LR A &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel) &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel) &#8594; A&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>short_circuit_conv</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>parametricity</span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_llen</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;xss i. length (xss!i)&quot;</span></span></span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#955;(xss,i). i&lt;length xss]<span class="hidden">&#8681;</span><sub>f</sub> LR A &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel &#8594; nat_rel&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* TODO: list_list is a proper subtype of list. So share operations! length, empty, ... *)</span></span></span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_len</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;length :: _ list list &#8658; _&quot;</span></span></span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;LR A &#8594; nat_rel&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    
</span><span>    </span><span class="keyword1"><span class="command">sepref_decl_op</span></span><span> </span><span>list_list_take</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;xss i l. (xss[i:=take l (xss!i)])&quot;</span></span></span><span> 
</span><span>      </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#955;((xss,i),l). i&lt;length xss &#8743; l&#8804;length (xss!i)]<span class="hidden">&#8681;</span><sub>f</sub> ((LR A &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel) &#215;<span class="hidden">&#8681;</span><sub>r</sub> nat_rel)&#8594; LR A&quot;</span></span></span><span> 
</span><span>      </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>conv_to_is_Nil</span><span> </span><span>short_circuit_conv</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>parametricity</span><span>
</span><span>    
</span><span>  </span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>list_list_custom_empty</span><span> </span><span class="delimiter">=</span><span> 
</span><span>    </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>rel</span><span> </span><span>empty</span><span> </span><span>PRE</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>op_custom_empty</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat &#8658; &#39;a list list&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>customize_hnr_aux</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(empty,(RETURN o (op_list_list_lempty::nat &#8658; &#39;a list list))) &#8712; [PRE]<span class="hidden">&#8681;</span><sub>a</sub> snat_assn<span class="hidden">&#8679;</span><sup>k</sup> &#8594; rel&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>op_custom_empty_def</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;op_custom_empty = op_list_list_lempty&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">sepref_register</span></span><span> </span><span>op_custom_empty</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat &#8658; &#39;c list list&quot;</span></span></span><span>
</span><span>  
</span><span>    </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_custom_empty</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;replicate n [] = op_custom_empty n&quot;</span></span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;op_list_list_lempty = op_custom_empty&quot;</span></span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;mop_list_list_lempty n = RETURN (op_custom_empty n)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>op_custom_empty_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp_all</span><span>
</span><span>  
</span><span>    </span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>custom_hnr</span><span class="delimiter">[</span><span>sepref_fr_rules</span><span class="delimiter">]</span><span> </span><span class="delimiter">=</span><span> </span><span>customize_hnr_aux</span><span class="delimiter">[</span><span>folded</span><span> </span><span>op_custom_empty_def</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Fold lemmas for manual folding.&#8250;</span></span></span><span>
</span><span>  </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* TODO: Why not use interface and op-id for that? *)</span></span></span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_op_list_list_push_back</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;xss[i:=xss!i@[x]] = op_list_list_push_back xss i x&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_op_list_list_pop_back</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(last (xss!i), xss[i:=butlast (xss!i)]) = op_list_list_pop_back xss i&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_op_list_list_upd</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;xss[i:=(xss!i)[j:=x]] = op_list_list_upd xss i j x&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_op_list_list_idx</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;xs!i!j = op_list_list_idx xs i j&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_op_list_list_llen</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;length (xs!i) = op_list_list_llen xs i&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>fold_op_list_list_take</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;xss[i:=take n (xss!i)] = op_list_list_take xss i n&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span>  </span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>fold_op_list_list</span><span> </span><span class="delimiter">=</span><span> 
</span><span>    </span><span>fold_op_list_list_push_back</span><span>
</span><span>    </span><span>fold_op_list_list_pop_back</span><span> 
</span><span>    </span><span>fold_op_list_list_upd</span><span>
</span><span>    </span><span>fold_op_list_list_idx</span><span>
</span><span>    </span><span>fold_op_list_list_llen</span><span>
</span><span>    </span><span>fold_op_list_list_take</span><span>  
</span><span>  
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>

</div>
</body>
<div class=body><footer><p><table border=0  width=700> <tr><th>Isabelle version:</th><th>AFP version:</th><th>IsaFoL version:</th><th>Last compilation:</th></tr>

<tr><td align="center">Isabelle2019 </td><td align="center">93cdb54371e6+ </td><td align="center">5222ffd4 </td><td align="center">Fri 06 Dec 2019 02:43:15 PM CET </td></tr></table></p><a href="https://imprint.mpi-klsb.mpg.de/mpi/mfleury">Imprint</a> / <a href="https://data-protection.mpi-klsb.mpg.de/mpi/mfleury">Data Protection</a></footer></div>

</html>


