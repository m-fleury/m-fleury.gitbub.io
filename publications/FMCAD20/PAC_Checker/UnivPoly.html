<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory UnivPoly (repository version)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory UnivPoly</h1>

<span class="command">theory</span> <span class="name">UnivPoly</span><br/>
<span class="keyword">imports</span> <a href="Module.html"><span class="name">Module</span></a> <a href="RingHom.html"><span class="name">RingHom</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*  Title:      HOL/Algebra/UnivPoly.thy
    Author:     Clemens Ballarin, started 9 December 1996
    Copyright:  Clemens Ballarin

Contributions, in particular on long division, by Jesus Aransay.
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>UnivPoly</span><span>
</span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>Module</span><span> </span><span>RingHom</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">section</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Univariate Polynomials&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Polynomials are formalised as modules with additional operations for
  extracting coefficients from polynomials and for obtaining monomials
  from coefficients and exponents (record &#8249;up_ring&#8250;).  The
  carrier set is a set of bounded functions from Nat to the
  coefficient domain.  Bounded means that these functions return zero
  above a certain bound (the degree).  There is a chapter on the
  formalisation of polynomials in the PhD thesis @{cite &quot;Ballarin:1999&quot;},
  which was implemented with axiomatic type classes.  This was later
  ported to Locales.
&#8250;</span></span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The Constructor for Univariate Polynomials&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Functions with finite support.
&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>bound</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>z</span><span> </span><span class="delimiter">::</span><span> </span><span class="tfree">&#39;a</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>n</span><span> </span><span class="delimiter">::</span><span> </span><span>nat</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>f</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat =&gt; &#39;a&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>bound</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!m. n &lt; m &#10233; f m = z&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">declare</span></span><span> </span><span>bound.intro</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">!</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>bound.bound</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>bound_below</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>bound</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound z m f&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>nonzero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f n &#8800; z&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &#8804; m&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>classical</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; ?thesis&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;m &lt; n&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>bound</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f n = z&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>nonzero</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>contradiction</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">record</span></span><span> </span><span class="delimiter">(</span><span class="tfree">&#39;a</span><span class="delimiter">,</span><span> </span><span class="tfree">&#39;p</span><span class="delimiter">)</span><span> </span><span>up_ring</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a, &#39;p) module&quot;</span></span></span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span>monom</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#39;a, nat] =&gt; &#39;p&quot;</span></span></span><span>
</span><span>  </span><span>coeff</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[&#39;p, nat] =&gt; &#39;a&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>
</span><span>  </span><span>up</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a, &#39;m) ring_scheme =&gt; (nat =&gt; &#39;a) set&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;up R = {f. f &#8712; UNIV &#8594; carrier R &#8743; (&#8707;n. bound &#120812;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> n f)}&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span> </span><span>UP</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#39;a, &#39;m) ring_scheme =&gt; (&#39;a, nat =&gt; &#39;a) up_ring&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;UP R = &#10631;
   carrier = up R,
   mult = (&#955;p&#8712;up R. &#955;q&#8712;up R. &#955;n. &#10753;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>i &#8712; {..n}. p i &#8855;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> q (n-i)),
   one = (&#955;i. if i=0 then &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> else &#120812;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>),
   zero = (&#955;i. &#120812;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>),
   add = (&#955;p&#8712;up R. &#955;q&#8712;up R. &#955;i. p i &#8853;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> q i),
   smult = (&#955;a&#8712;carrier R. &#955;p&#8712;up R. &#955;i. a &#8855;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> p i),
   monom = (&#955;a&#8712;carrier R. &#955;n i. if i=n then a else &#120812;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>),
   coeff = (&#955;p&#8712;up R. &#955;n. p n)&#10632;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Properties of the set of polynomials \&lt;^term&gt;&#8249;up&#8250;.
&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>mem_upI</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| &#8896;n. f n &#8712; carrier R; &#8707;n. bound (zero R) n f |] ==&gt; f &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>up_def</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>mem_upD</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; up R ==&gt; f n &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>up_def</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>bound_upD</span><span> </span><span class="delimiter">[</span><span>dest</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; up R &#10233; &#8707;n. bound &#120812; n f&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>up_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_one_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;n. if n = 0 then &#120813; else &#120812;) &#8712; up R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>up_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_smult_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; p &#8712; up R |] ==&gt; (&#955;i. a &#8855; p i) &#8712; up R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_add_closed</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; up R; q &#8712; up R |] ==&gt; (&#955;i. p i &#8853; q i) &#8712; up R&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; up R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p n &#8853; q n &#8712; carrier R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>UP</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; up R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;n. bound &#120812; n (&#955;i. p i &#8853; q i)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>UP</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>boundn</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; n p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>UP</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>m</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>boundm</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; m q&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; (max n m) (&#955;i. p i &#8853; q i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>i</span><span>
</span><span>      </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;max n m &lt; i&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>boundn</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>boundm</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>UP</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p i &#8853; q i = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_a_inv_closed</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; up R ==&gt; (&#955;i. &#8854; (p i)) &#8712; up R&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; n p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; n (&#955;i. &#8854; p i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>bound_def</span><span> </span><span>minus_equality</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;n. bound &#120812; n (&#955;i. &#8854; p i)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_minus_closed</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; up R; q &#8712; up R |] ==&gt; (&#955;i. p i &#8854; q i) &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>a_minus_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>mem_upD</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>p</span><span> </span><span>R</span><span class="delimiter">]</span><span> </span><span>mem_upD</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>q</span><span> </span><span>R</span><span class="delimiter">]</span><span> </span><span>up_add_closed</span><span> </span><span>up_a_inv_closed</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_mult_closed</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; up R; q &#8712; up R |] ==&gt;
  (&#955;n. &#10753;i &#8712; {..n}. p i &#8855; q (n-i)) &#8712; up R&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; up R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {..n}. p i &#8855; q (n-i)) &#8712; carrier R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>mem_upD</span><span>  </span><span>funcsetI</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>UP</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; up R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; up R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;n. bound &#120812; n (&#955;n. &#10753;i &#8712; {..n}. p i &#8855; q (n-i))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>UP</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>boundn</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; n p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>UP</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>m</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>boundm</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; m q&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; (n + m) (&#955;n. &#10753;i &#8712; {..n}. p i &#8855; q (n - i))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>bound</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n + m &lt; k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>i</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p i &#8855; q (k-i) = &#120812;&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &lt; i&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>          </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>boundn</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p i = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>UP</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q (k-i) &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>          </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>          </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>bound</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;m &lt; k-i&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>          </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>boundm</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q (k-i) = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>UP</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p i &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {..k}. p i &#8855; q (k-i)) = &#120812;&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Effect of Operations on Coefficients&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>UP</span><span> </span><span class="delimiter">=</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>R</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="delimiter">)</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>P</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">defines</span></span><span> </span><span>P_def</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;P == UP R&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>UP_ring</span><span> </span><span class="delimiter">=</span><span> </span><span>UP</span><span> </span><span class="delimiter">+</span><span> </span><span>R</span><span class="delimiter">?</span><span class="delimiter">:</span><span> </span><span>ring</span><span> </span><span>R</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>UP_cring</span><span> </span><span class="delimiter">=</span><span> </span><span>UP</span><span> </span><span class="delimiter">+</span><span> </span><span>R</span><span class="delimiter">?</span><span class="delimiter">:</span><span> </span><span>cring</span><span> </span><span>R</span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_cring</span><span> </span><span class="delimiter">&lt;</span><span> </span><span>UP_ring</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>intro_locales</span><span> </span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>P_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>UP_domain</span><span> </span><span class="delimiter">=</span><span> </span><span>UP</span><span> </span><span class="delimiter">+</span><span> </span><span>R</span><span class="delimiter">?</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;domain&quot;</span></span></span><span> </span><span>R</span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_domain</span><span> </span><span class="delimiter">&lt;</span><span> </span><span>UP_cring</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>intro_locales</span><span> </span><span class="delimiter">[</span><span>1</span><span class="delimiter">]</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>P_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Temporarily declare @{thm P_def} as simp rule.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">declare</span></span><span> </span><span>P_def</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_eqI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>prem</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!n. coeff P p n = coeff P q n&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p = q&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>prem</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p x = q x&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P ==&gt; coeff P p n &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* Theorems generalised from commutative rings to rings by Jesus Aransay. *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R ==&gt; coeff P (monom P a m) n = (if m=n then a else &#120812;)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;n. if n = m then a else &#120812;) &#8712; up R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>up_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> n = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_one</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> n = (if n=0 then &#120813; else &#120812;)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>up_one_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_smult</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; p &#8712; carrier P |] ==&gt; coeff P (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n = a &#8855; coeff P p n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_smult_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_add</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; carrier P; q &#8712; carrier P |] ==&gt; coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) n = coeff P p n &#8853; coeff P q n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_add_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; carrier P; q &#8712; carrier P |] ==&gt; coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) n = (&#10753;i &#8712; {..n}. coeff P p i &#8855; coeff P q (n-i))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_mult_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Polynomials Form a Ring.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Operations are closed over \&lt;^term&gt;&#8249;P&#8250;.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_mult_closed</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; carrier P; q &#8712; carrier P |] ==&gt; p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_mult_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_one_closed</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_one_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_zero_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_a_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8712; carrier P; q &#8712; carrier P |] ==&gt; p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_add_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R ==&gt; monom P a n &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_def</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_closed</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; p &#8712; carrier P |] ==&gt; a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>up_smult_closed</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">declare</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP</span><span class="delimiter">)</span><span> </span><span>P_def</span><span> </span><span class="delimiter">[</span><span>simp</span><span> </span><span>del</span><span class="delimiter">]</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Algebraic ring properties&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_a_assoc</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r = p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">,</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a_assoc</span><span> </span><span>R</span><span class="delimiter">,</span><span> </span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_l_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">,</span><span> </span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_l_neg_ex</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;q &#8712; carrier P. q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?q</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;i. &#8854; (p i)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?q &#8712; carrier P&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>P_def</span><span> </span><span>up_a_inv_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>coeff</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!n. coeff P ?q n = &#8854; (coeff P p n)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>P_def</span><span> </span><span>up_a_inv_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>up_eqI</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span> </span><span>closed</span><span> </span><span>coeff</span><span> </span><span>R.l_neg</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>closed</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_a_comm</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q = q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">,</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a_comm</span><span> </span><span>R</span><span class="delimiter">,</span><span> </span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_m_assoc</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r = p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (q &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span>c</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat=&gt;&#39;a&quot;</span></span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; UNIV &#8594; carrier R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;b &#8712; UNIV &#8594; carrier R&quot;</span></span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;c &#8712; UNIV &#8594; carrier R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k &lt;= n ==&gt;
      (&#10753;j &#8712; {..k}. (&#10753;i &#8712; {..j}. a i &#8855; b (j-i)) &#8855; c (n-j)) =
      (&#10753;j &#8712; {..k}. a j &#8855; (&#10753;i &#8712; {..k-j}. b i &#8855; c (n-j-i)))&quot;</span></span></span><span>
</span><span>      </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;_ &#10233; ?eq k&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>k</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span> </span><span>m_assoc</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Suc</span><span> </span><span>k</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k &lt;= n&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?eq k&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Suc</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span>
</span><span>             </span><span>add</span><span class="delimiter">:</span><span> </span><span>Suc_diff_le</span><span> </span><span>Pi_def</span><span> </span><span>l_distr</span><span> </span><span>r_distr</span><span> </span><span>m_assoc</span><span class="delimiter">)</span><span>
</span><span>           </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span> </span><span>a_ac</span><span> </span><span>finsum_ldistr</span><span> </span><span>m_assoc</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P ((p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r) n = coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (q &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r)) n&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_r_one</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> = p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>) n = coeff P p n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Suc</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>      </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*JE: in the locale UP_cring the proof was solved only with &quot;by (simp del: finsum_Suc add: finsum_Suc2 Pi_def)&quot;, but I did not get it to work here*)</span></span></span></span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>nn</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>Succ</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n = Suc nn&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>) (Suc nn) = coeff P p (Suc nn)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>) (Suc nn) = (&#10753;i&#8712;{..Suc nn}. coeff P p i &#8855; (if Suc nn &#8804; i then &#120813; else &#120812;))&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = coeff P p (Suc nn) &#8855; (if Suc nn &#8804; Suc nn then &#120813; else &#120812;) &#8853; (&#10753;i&#8712;{..nn}. coeff P p i &#8855; (if Suc nn &#8804; i then &#120813; else &#120812;))&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>finsum_Suc</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i::nat. coeff P p i &#8855; (if Suc nn &#8804; i then &#120813; else &#120812;))&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nn&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = coeff P p (Suc nn) &#8855; (if Suc nn &#8804; Suc nn then &#120813; else &#120812;)&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i&#8712;{..nn}. coeff P p i &#8855; (if Suc nn &#8804; i then &#120813; else &#120812;)) = (&#10753;i&#8712;{..nn}. &#120812;)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>finsum_cong</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..nn}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..nn}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i::nat. coeff P p i &#8855; (if Suc nn &#8804; i then &#120813; else &#120812;))&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i::nat. &#120812;)&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span>
</span><span>            </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>r_zero</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = coeff P p (Suc nn)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>        </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Succ</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_l_one</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (&#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n = coeff P p n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>finsum_Suc</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>finsum_Suc2</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_l_distr</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r = (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (q &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>l_distr</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">,</span><span> </span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_r_distr</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) = (r &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (r &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>r_distr</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">,</span><span> </span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>UP_ring</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ring P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>ringI</span><span> </span><span>abelian_groupI</span><span> </span><span>monoidI</span><span> </span><span>UP_a_assoc</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>UP_a_comm</span><span> </span><span>UP_l_neg_ex</span><span> </span><span>UP_m_assoc</span><span> </span><span>UP_l_distr</span><span> </span><span>UP_r_distr</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Polynomials Form a Commutative Ring.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_cring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_m_comm</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q = q &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>a</span><span> </span><span>b</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;nat=&gt;&#39;a&quot;</span></span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; UNIV &#8594; carrier R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;b &#8712; UNIV &#8594; carrier R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k &lt;= n ==&gt;
      (&#10753;i &#8712; {..k}. a i &#8855; b (n-i)) = (&#10753;i &#8712; {..k}. a (k-i) &#8855; b (i+n-k))&quot;</span></span></span><span>
</span><span>      </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;_ &#10233; ?eq k&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>k</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Suc</span><span> </span><span>k</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>subst</span><span> </span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>finsum_Suc2</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span> </span><span>a_comm</span><span class="delimiter">)</span><span class="delimiter">+</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>l</span><span> </span><span class="delimiter">=</span><span> </span><span>this</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R1</span><span> </span><span>R2</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) n =  coeff P (q &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R1</span><span> </span><span>R2</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R2</span><span> </span><span>R1</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>l</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. coeff P p i)&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. coeff P q i)&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span> </span><span>m_comm</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R1</span><span> </span><span>R2</span><span class="delimiter">)</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Polynomials over a commutative ring for a commutative ring&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>UP_cring</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;cring P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UP_ring</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>cring_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>comm_monoidI</span><span> </span><span>UP_m_assoc</span><span> </span><span>UP_m_comm</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_a_inv_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P ==&gt; &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>abelian_group.a_inv_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>ring.is_abelian_group</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>UP_ring</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_a_inv</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n = &#8854; (coeff P p n)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>coeff_closed</span><span> </span><span>UP_a_inv_closed</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n = &#8854; coeff P p n &#8853; (coeff P p n &#8853; coeff P (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>algebra</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =  &#8854; (coeff P p n)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>coeff_add</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>coeff_add</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span>
</span><span>      </span><span>abelian_group.r_neg</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>ring.is_abelian_group</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>UP_ring</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_ring</span><span> </span><span class="delimiter">&lt;</span><span> </span><span>P</span><span class="delimiter">?</span><span class="delimiter">:</span><span> </span><span>ring</span><span> </span><span>P</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UP_ring</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_cring</span><span> </span><span class="delimiter">&lt;</span><span> </span><span>P</span><span class="delimiter">?</span><span class="delimiter">:</span><span> </span><span>cring</span><span> </span><span>P</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UP_cring</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Polynomials Form an Algebra&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_l_distr</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; b &#8712; carrier R; p &#8712; carrier P |] ==&gt;
  (a &#8853; b) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> b &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.l_distr</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_r_distr</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; p &#8712; carrier P; q &#8712; carrier P |] ==&gt;
  a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) = a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.r_distr</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_assoc1</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; b &#8712; carrier R; p &#8712; carrier P |] ==&gt;
      (a &#8855; b) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (b &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.m_assoc</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P ==&gt; &#120812; &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_one</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P ==&gt; &#120813; &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = p&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_smult_assoc2</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; p &#8712; carrier P; q &#8712; carrier P |] ==&gt;
  (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q = a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.finsum_rdistr</span><span> </span><span>R.m_assoc</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Interpretation of lemmas from \&lt;^term&gt;&#8249;algebra&#8250;.
&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>cring</span><span class="delimiter">)</span><span> </span><span>cring</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;cring R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_cring</span><span class="delimiter">)</span><span> </span><span>UP_algebra</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;algebra R P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>algebraI</span><span> </span><span>R.cring</span><span> </span><span>UP_cring</span><span> </span><span>UP_smult_l_distr</span><span> </span><span>UP_smult_r_distr</span><span>
</span><span>    </span><span>UP_smult_assoc1</span><span> </span><span>UP_smult_assoc2</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_cring</span><span> </span><span class="delimiter">&lt;</span><span> </span><span>algebra</span><span> </span><span>R</span><span> </span><span>P</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UP_algebra</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Further Lemmas Involving Monomials&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120812; n = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>P_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_mult_is_smult</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P a 0 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p = a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P a 0 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n = coeff P (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_Suc2</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>R.finsum_Suc</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_one</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; 0 = &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_add</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; b &#8712; carrier R |] ==&gt;
  monom P (a &#8853; b) n = monom P a n &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P b n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_one_Suc</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; (Suc n) = monom P &#120813; n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P &#120813; (Suc n)) k = coeff P (monom P &#120813; n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1) k&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k = Suc n&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>less_add_diff</span><span class="delimiter">:</span><span>
</span><span>        </span><span class="string"><span class="delete"><span class="delete">&quot;!!i. [| n &lt; i; i &lt;= n + m |] ==&gt; n + m - i &lt; m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P &#120813; (Suc n)) k = &#120813;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..&lt;n} &#8746; {n}. coeff P (monom P &#120813; n) i &#8855;
        coeff P (monom P &#120813; 1) (k - i))&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712;  {..n}. coeff P (monom P &#120813; n) i &#8855;
        coeff P (monom P &#120813; 1) (k - i))&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_singleton</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..n} &#8746; {n&lt;..k}. coeff P (monom P &#120813; n) i &#8855;
        coeff P (monom P &#120813; 1) (k - i))&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span>
</span><span>          </span><span>order_less_imp_not_eq</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P (monom P &#120813; n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1) k&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>    </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>neq</span><span> </span><span class="delimiter">=</span><span> </span><span>False</span><span>
</span><span>    </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?s</span><span> </span><span class="delimiter">=</span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;&#955;i. (if n = i then &#120813; else &#120812;) &#8855; (if Suc 0 = k - i then &#120813; else &#120812;)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>neq</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P &#120813; (Suc n)) k = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..k}. ?s i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {..&lt;n}. ?s i) = &#120812;&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>neq</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f2</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {n}. ?s i) = &#120812;&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span> </span><span>arith</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f3</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &lt; k ==&gt; (&#10753;i &#8712; {n&lt;..k}. ?s i) = &#120812;&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>order_less_imp_not_eq</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k &lt; n&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>n_le_k</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &lt;= k&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>        </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>        </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n = k&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120812; = (&#10753;i &#8712; {..&lt;n} &#8746; {n}. ?s i)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..k}. ?s i)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_singleton</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>          </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>n_le_k</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>n_less_k</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &lt; k&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>          </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>neq</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120812; = (&#10753;i &#8712; {..&lt;n} &#8746; {n}. ?s i)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.finsum_Un_disjoint</span><span> </span><span>f1</span><span> </span><span>f2</span><span> </span><span>Pi_def</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>Un_insert_right</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..n}. ?s i)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_singleton</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>n_less_k</span><span> </span><span>neq</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..n} &#8746; {n&lt;..k}. ?s i)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.finsum_Un_disjoint</span><span> </span><span>f3</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>n_less_k</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..k}. ?s i)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P (monom P &#120813; n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1) k&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_one_Suc2</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; (Suc n) = monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; n&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Suc</span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span class="delimiter">::</span><span> </span><span>nat</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>hypo</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; (Suc k) = monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; k&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; (Suc (Suc k)) = monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; (Suc k)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>lhs</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; (Suc (Suc k)) = monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; k &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>monom_one_Suc</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Suc k&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>hypo</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>cl</span><span> </span><span class="delimiter">=</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span class="delimiter">]</span><span>
</span><span>      </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>clk</span><span> </span><span class="delimiter">=</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>k</span><span class="delimiter">]</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>rhs</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; (Suc k) = monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; k &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>monom_one_Suc</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>k</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>sym</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>m_assoc</span><span>  </span><span class="delimiter">[</span><span>OF</span><span> </span><span>cl</span><span> </span><span>clk</span><span> </span><span>cl</span><span class="delimiter">]</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>lhs</span><span> </span><span>rhs</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The following corollary follows from lemmas @{thm &quot;monom_one_Suc&quot;}
  and @{thm &quot;monom_one_Suc2&quot;}, and is trivial in \&lt;^term&gt;&#8249;UP_cring&#8250;&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">corollary</span></span><span> </span><span>monom_one_comm</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; k &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1 = monom P &#120813; 1 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; k&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>monom_one_Suc</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span>monom_one_Suc2</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_mult_smult</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; b &#8712; carrier R |] ==&gt; monom P (a &#8855; b) n = a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P b n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_one_mult</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; (n + m) = monom P &#120813; n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; m&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>add_Suc</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>monom_one_Suc</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Suc.hyps</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>m_assoc</span><span> </span><span>monom_one_comm</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_one_mult_comm</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813; n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; m = monom P &#120813; m &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>monom_one_mult</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_mult</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a_in_R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>b_in_R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;b &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P (a &#8855; b) (n + m) = monom P a n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P b m&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P (a &#8855; b) (n + m)) k = coeff P (monom P a n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P b m) k&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n + m = k&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>True</span><span> </span><span class="delimiter">[</span><span>symmetric</span><span class="delimiter">]</span><span>
</span><span>          </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>b_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n + m&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>          </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>b_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_cong</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{.. n + m}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{.. n + m}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. (if n = i then a else &#120812;) &#8855; (if m = n + m - i then b else &#120812;))&quot;</span></span></span><span>
</span><span>          </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. if n = i then a &#8855; b else &#120812;)&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>          </span><span>a_in_R</span><span> </span><span>b_in_R</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>simp_implies_def</span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_singleton</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>n</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{.. n + m}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. a &#8855; b)&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.m_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span> </span><span>b_in_R</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n + m&quot;</span></span></span><span> </span><span>k</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>False</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>b_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>k</span><span class="delimiter">]</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>b_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_cong</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..k}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..k}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. (if n = i then a else &#120812;) &#8855; (if m = k - i then b else &#120812;))&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. &#120812;)&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>        </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span>simp_implies_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a_in_R</span><span> </span><span>b_in_R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a_in_R</span><span> </span><span>b_in_R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_a_inv</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R ==&gt; monom P (&#8854; a) n = &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_inj</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;inj_on (&#955;a. monom P a n) (carrier R)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>inj_onI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span> </span><span>y</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x &#8712; carrier R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;y &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P x n = monom P y n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P x n) n = coeff P (monom P y n) n&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x = y&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The Degree Function&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>
</span><span>  </span><span>deg</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[(&#39;a, &#39;m) ring_scheme, nat =&gt; &#39;a] =&gt; nat&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p = (LEAST n. bound &#120812;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> n (coeff (UP R) p))&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_aboveI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| (!!m. n &lt; m ==&gt; coeff P p m = &#120812;); p &#8712; carrier P |] ==&gt; deg R p &lt;= n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>deg_def</span><span> </span><span>P_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>Least_le</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(*
lemma coeff_bound_ex: &quot;EX n. bound n (coeff p)&quot;
proof -
  have &quot;(&#955;n. coeff p n) : UP&quot; by (simp add: coeff_def Rep_UP)
  then obtain n where &quot;bound n (coeff p)&quot; by (unfold UP_def) fast
  then show ?thesis ..
qed

lemma bound_coeff_obtain:
  assumes prem: &quot;(!!n. bound n (coeff p) ==&gt; P)&quot; shows &quot;P&quot;
proof -
  have &quot;(&#955;n. coeff p n) : UP&quot; by (simp add: coeff_def Rep_UP)
  then obtain n where &quot;bound n (coeff p)&quot; by (unfold UP_def) fast
  with prem show P .
qed
*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_aboveD</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &lt; m&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p m = &#120812;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;p &#8712; carrier P&#8250;</span></span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; n (coeff P p)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>UP_def</span><span> </span><span>P_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; (deg R p) (coeff P p)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>deg_def</span><span> </span><span>P_def</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>LeastI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;deg R p &lt; m&#8250;</span></span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_belowI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>non_zero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &#8800; 0 &#10233; coeff P p n &#8800; &#120812;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n &#8804; deg R p&quot;</span></span></span><span>
</span><span class="comment">&#8213; &#8249;Logically, this is a slightly stronger version of
   @{thm [source] deg_aboveD}&#8250;</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;n=0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p n &#8800; &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>non_zero</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; deg R p &lt; n&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>dest</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lcoeff_nonzero_deg</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>deg</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &#8800; 0&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p (deg R p) &#8800; &#120812;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>m</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &#8804; m&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>m_coeff</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p m &#8800; &#120812;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>minus</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;(n::nat) m. n &#8800; 0 &#10233; (n - Suc 0 &lt; m) = (n &#8804; m)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>deg</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p - 1 &lt; (LEAST n. bound &#120812; n (coeff P p))&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>deg_def</span><span> </span><span>P_def</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; bound &#120812; (deg R p - 1) (coeff P p)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>not_less_Least</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;m. deg R p - 1 &lt; m &#8743; coeff P p m &#8800; &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>bound_def</span><span class="delimiter">)</span><span> </span><span>fast</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;m. deg R p &#8804; m &#8743; coeff P p m &#8800; &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg</span><span> </span><span>minus</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>that</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>deg_belowI</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p = m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>m_coeff</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lcoeff_nonzero_nonzero</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>deg</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p = 0&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>nonzero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p 0 &#8800; &#120812;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;m. coeff P p m &#8800; &#120812;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>classical</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; ?thesis&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>nonzero</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>contradiction</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>m</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>coeff</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p m &#8800; &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;m &#8804; deg R p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;m = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>coeff</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lcoeff_nonzero</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>neq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p (deg R p) &#8800; &#120812;&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p = 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>neq</span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lcoeff_nonzero_nonzero</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>neq</span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>lcoeff_nonzero_deg</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_eqI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| &#8896;m. n &lt; m &#10233; coeff P p m = &#120812;;
      &#8896;n. n &#8800; 0 &#10233; coeff P p n &#8800; &#120812;; p &#8712; carrier P |] ==&gt; deg R p = n&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>le_antisym</span><span> </span><span>deg_aboveI</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Degree and polynomial operations&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_add</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P &#10233; q &#8712; carrier P &#10233;
  deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8804; max (deg R p) (deg R q)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">by</span></span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_monom_le</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R &#10233; deg R (monom P a n) &#8804; n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>intro</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_monom</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8800; &#120812;; a &#8712; carrier R |] ==&gt; deg R (monom P a n) = n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fastforce</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>le_antisym</span><span> </span><span>deg_aboveI</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_const</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (monom P a 0) = 0&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>le_antisym</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (monom P a 0) &#8804; 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;0 &#8804; deg R (monom P a 0)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_zero</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;deg R &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> = 0&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>le_antisym</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8804; 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;0 &#8804; deg R &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_one</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;deg R &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> = 0&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>le_antisym</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8804; 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;0 &#8804; deg R &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_uminus</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) = deg R p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>le_antisym</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) &#8804; deg R p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveI</span><span> </span><span>deg_aboveD</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &#8804; deg R (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_belowI</span><span> </span><span>lcoeff_nonzero_deg</span><span>
</span><span>      </span><span>inj_on_eq_iff</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.a_inv_inj</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>_</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120812;&quot;</span></span></span><span class="delimiter">,</span><span> </span><span>simplified</span><span class="delimiter">]</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The following lemma is later \emph{overwritten} by the most
  specific one for domains, &#8249;deg_smult&#8250;.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_smult_ring</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| a &#8712; carrier R; p &#8712; carrier P |] ==&gt;
  deg R (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) &#8804; (if a = &#120812; then 0 else deg R p)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a = &#120812;&quot;</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveI</span><span> </span><span>deg_aboveD</span><span class="delimiter">)</span><span class="delimiter">+</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_domain</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_smult</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) = (if a = &#120812; then 0 else deg R p)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>le_antisym</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) &#8804; (if a = &#120812; then 0 else deg R p)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_smult_ring</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(if a = &#120812; then 0 else deg R p) &#8804; deg R (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a = &#120812;&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span class="delimiter">,</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_belowI</span><span> </span><span>lcoeff_nonzero_deg</span><span> </span><span>integral_iff</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_mult_ring</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8804; deg R p + deg R q&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>boundm</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p + deg R q &lt; m&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span> </span><span>i</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>boundk</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p + deg R q &lt; k&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p i &#8855; coeff P q (k - i) = &#120812;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &lt; i&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>boundk</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R q &lt; k - i&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>boundm</span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) m = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_domain</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_mult</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>; q &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>; p &#8712; carrier P; q &#8712; carrier P |] ==&gt;
  deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) = deg R p + deg R q&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>le_antisym</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot; q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8804; deg R p + deg R q&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_mult_ring</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?s</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. coeff P p i &#8855; coeff P q (deg R p + deg R q - i))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>nz</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>less_add_diff</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!(k::nat) n m. k &lt; n ==&gt; m &lt; n + m - k&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p + deg R q &#8804; deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">,</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {.. deg R p + deg R q}. ?s i)
      = (&#10753;i &#8712; {..&lt; deg R p} &#8746; {deg R p .. deg R p + deg R q}. ?s i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {deg R p .. deg R p + deg R q}. ?s i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span>
</span><span>        </span><span>deg_aboveD</span><span> </span><span>less_add_diff</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;...= (&#10753;i &#8712; {deg R p} &#8746; {deg R p &lt;.. deg R p + deg R q}. ?s i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_singleton</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P p (deg R p) &#8855; coeff P q (deg R q)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {.. deg R p + deg R q}. ?s i)
      = coeff P p (deg R p) &#8855; coeff P q (deg R q)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>nz</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i &#8712; {.. deg R p + deg R q}. ?s i) &#8800; &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>integral_iff</span><span> </span><span>lcoeff_nonzero</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The following lemmas also can be lifted to \&lt;^term&gt;&#8249;UP_ring&#8250;.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_finsum</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>fin</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;finite A&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; A &#8594; carrier P ==&gt;
    coeff P (finsum P p A) k = (&#10753;i &#8712; A. coeff P (p i) k)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>fin</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>induct</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_repr</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. monom P (coeff P p i) i) = p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?s</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. monom P (coeff P p i) i)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>k</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>RR</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!i. (if i = k then coeff P p i else &#120812;) &#8712; carrier R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. ?s i) k = coeff P p k&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;k &#8804; deg R p&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>    </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. ?s i) k =
          coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..k} &#8746; {k&lt;..deg R p}. ?s i) k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>True</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..k}. ?s i) k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.finsum_Un_disjoint</span><span>
</span><span>        </span><span>ivl_disj_int_one</span><span> </span><span>order_less_imp_not_eq2</span><span> </span><span>coeff_finsum</span><span> </span><span>R</span><span> </span><span>RR</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..&lt;k} &#8746; {k}. ?s i) k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_singleton</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P p k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>coeff_finsum</span><span> </span><span>deg_aboveD</span><span> </span><span>R</span><span> </span><span>RR</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>    </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. ?s i) k =
          coeff P (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..&lt;deg R p} &#8746; {deg R p}. ?s i) k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_singleton</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = coeff P p k&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>R.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>coeff_finsum</span><span> </span><span>deg_aboveD</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>up_repr_le</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| deg R p &lt;= n; p &#8712; carrier P |] ==&gt;
  (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..n}. monom P (coeff P p i) i) = p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?s</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. monom P (coeff P p i) i)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &lt;= n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;finsum P ?s {..n} = finsum P ?s ({..deg R p} &#8746; {deg R p&lt;..n})&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = finsum P ?s {..deg R p}&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>P.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>P.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span>
</span><span>      </span><span>deg_aboveD</span><span> </span><span>R</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = p&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_repr</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Polynomials over Integral Domains&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>domainI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>cring</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cring R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>one_not_zero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;one R &#8800; zero R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>integral</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8896;a b. [| mult R a b = zero R; a &#8712; carrier R;
      b &#8712; carrier R |] ==&gt; a = zero R &#8744; b = zero R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;domain R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>domain.intro</span><span> </span><span>domain_axioms.intro</span><span> </span><span>cring.axioms</span><span> </span><span>assms</span><span>
</span><span>    </span><span>del</span><span class="delimiter">:</span><span> </span><span>disjCI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_domain</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_one_not_zero</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;&#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> 0 = (coeff P &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> 0)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#120813; = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R.one_not_zero</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;False&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>contradiction</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_integral</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>; p &#8712; carrier P; q &#8712; carrier P |] ==&gt; p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; q = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>p</span><span> </span><span>q</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>pq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; q = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>classical</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>c</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; (p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; q = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p + deg R q = deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>pq</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p + deg R q = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p = 0 &#8743; deg R q = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f1</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p = (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..0}. monom P (coeff P p i) i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>up_repr_le</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = monom P (coeff P p 0) 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>p</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p = monom P (coeff P p 0) 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f1</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q = (&#10753;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i &#8712; {..0}. monom P (coeff P q i) i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>up_repr_le</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = monom P (coeff P q 0) 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>q</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q = monom P (coeff P q 0) 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p 0 &#8855; coeff P q 0 = coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>pq</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p 0 &#8855; coeff P q 0 = &#120812;&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p 0 = &#120812; &#8744; coeff P q 0 = &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>R.integral_iff</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>p</span><span> </span><span>q</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; q = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>UP_domain</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;domain P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>domainI</span><span> </span><span>UP_cring</span><span> </span><span>UP_one_not_zero</span><span> </span><span>UP_integral</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>disjCI</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Interpretation of theorems from \&lt;^term&gt;&#8249;domain&#8250;.
&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_domain</span><span> </span><span class="delimiter">&lt;</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;domain&quot;</span></span></span><span> </span><span>P</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>intro_locales</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>domain.axioms</span><span> </span><span>UP_domain</span><span class="delimiter">)</span><span class="delimiter">+</span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The Evaluation Homomorphism and Universal Property&#8250;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* alternative congruence rule (possibly more efficient)
lemma (in abelian_monoid) finsum_cong2:
  &quot;[| !!i. i &#8712; A ==&gt; f i &#8712; carrier G = True; A = B;
  !!i. i &#8712; B ==&gt; f i = g i |] ==&gt; finsum G f A = finsum G g B&quot;
  sorry*)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>abelian_monoid</span><span class="delimiter">)</span><span> </span><span>boundD_carrier</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| bound &#120812; n f; n &lt; m |] ==&gt; f m &#8712; carrier G&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>diagonal_sum</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| f &#8712; {..n + m::nat} &#8594; carrier R; g &#8712; {..n + m} &#8594; carrier R |] ==&gt;
  (&#10753;k &#8712; {..n + m}. &#10753;i &#8712; {..k}. f i &#8855; g (k - i)) =
  (&#10753;k &#8712; {..n + m}. &#10753;i &#8712; {..n + m - k}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>Rf</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; {..n + m} &#8594; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>Rg</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8712; {..n + m} &#8594; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>j</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;j &lt;= n + m ==&gt;
      (&#10753;k &#8712; {..j}. &#10753;i &#8712; {..k}. f i &#8855; g (k - i)) =
      (&#10753;k &#8712; {..j}. &#10753;i &#8712; {..j - k}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>j</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>Rf</span><span> </span><span>Rg</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Suc</span><span> </span><span>j</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>R6</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!i k. [| k &lt;= j; i &lt;= Suc j - k |] ==&gt; g i &#8712; carrier R&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>funcset_mem</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>Rg</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>R8</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!i k. [| k &lt;= Suc j; i &lt;= k |] ==&gt; g (k - i) &#8712; carrier R&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>funcset_mem</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>Rg</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>R9</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!i k. [| k &lt;= Suc j |] ==&gt; f k &#8712; carrier R&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>funcset_mem</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>Rf</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>R10</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!i k. [| k &lt;= Suc j; i &lt;= Suc j - k |] ==&gt; g i &#8712; carrier R&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>funcset_mem</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>Rg</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>R11</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g 0 &#8712; carrier R&quot;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>funcset_mem</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>Rg</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>Suc</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Suc_diff_le</span><span> </span><span>a_ac</span><span>
</span><span>          </span><span>Pi_def</span><span> </span><span>R6</span><span> </span><span>R8</span><span> </span><span>R9</span><span> </span><span>R10</span><span> </span><span>R11</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>cauchy_product</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>bf</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; n f&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>bg</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;bound &#120812; m g&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>Rf</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; {..n} &#8594; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>Rg</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8712; {..m} &#8594; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;k &#8712; {..n + m}. &#10753;i &#8712; {..k}. f i &#8855; g (k - i)) =
    (&#10753;i &#8712; {..n}. f i) &#8855; (&#10753;i &#8712; {..m}. g i)&quot;</span></span></span><span>      </span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* State reverse direction? *)</span></span></span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!x. f x &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f x &#8712; carrier R&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Rf</span><span> </span><span>bf</span><span> </span><span>boundD_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x &lt;= n&quot;</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>g</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;!!x. g x &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>x</span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g x &#8712; carrier R&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Rg</span><span> </span><span>bg</span><span> </span><span>boundD_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x &lt;= m&quot;</span></span></span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;k &#8712; {..n + m}. &#10753;i &#8712; {..k}. f i &#8855; g (k - i)) =
      (&#10753;k &#8712; {..n + m}. &#10753;i &#8712; {..n + m - k}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>diagonal_sum</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;k &#8712; {..n} &#8746; {n&lt;..n + m}. &#10753;i &#8712; {..n + m - k}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;k &#8712; {..n}. &#10753;i &#8712; {..n + m - k}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span>
</span><span>      </span><span>add</span><span class="delimiter">:</span><span> </span><span>bound.bound</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>bf</span><span class="delimiter">]</span><span> </span><span>finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f</span><span> </span><span>g</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;k &#8712; {..n}. &#10753;i &#8712; {..m} &#8746; {m&lt;..n + m - k}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span> </span><span>le_add_diff</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;k &#8712; {..n}. &#10753;i &#8712; {..m}. f k &#8855; g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span>
</span><span>      </span><span>add</span><span class="delimiter">:</span><span> </span><span>bound.bound</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>bg</span><span class="delimiter">]</span><span> </span><span>finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>f</span><span> </span><span>g</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = (&#10753;i &#8712; {..n}. f i) &#8855; (&#10753;i &#8712; {..m}. g i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>finsum_ldistr</span><span> </span><span>diagonal_sum</span><span> </span><span>Pi_def</span><span class="delimiter">,</span><span>
</span><span>      </span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>finsum_rdistr</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_ring</span><span class="delimiter">)</span><span> </span><span>const_ring_hom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;a. monom P a 0) &#8712; ring_hom R P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>ring_hom_memI</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>up_eqI</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>monom_mult_is_smult</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>
</span><span>  </span><span>eval</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;[(&#39;a, &#39;m) ring_scheme, (&#39;b, &#39;n) ring_scheme,
           &#39;a =&gt; &#39;b, &#39;b, nat =&gt; &#39;a] =&gt; &#39;b&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S phi s = (&#955;p &#8712; carrier (UP R).
    &#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>i &#8712; {..deg R p}. phi (coeff (UP R) p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>eval_on_carrier</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>S</span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">structure</span></span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P ==&gt;
  eval R S phi s p = (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. phi (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>eval_def</span><span class="delimiter">,</span><span> </span><span>fold</span><span> </span><span>P_def</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>eval_extensional</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S phi p &#8712; extensional (carrier P)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>eval_def</span><span class="delimiter">,</span><span> </span><span>fold</span><span> </span><span>P_def</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The universal property of the polynomial ring&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>UP_pre_univ_prop</span><span> </span><span class="delimiter">=</span><span> </span><span>ring_hom_cring</span><span> </span><span class="delimiter">+</span><span> </span><span>UP_cring</span><span>
</span><span>
</span><span class="keyword1"><span class="command">locale</span></span><span> </span><span>UP_univ_prop</span><span> </span><span class="delimiter">=</span><span> </span><span>UP_pre_univ_prop</span><span> </span><span class="delimiter">+</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">fixes</span></span><span> </span><span>s</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>Eval</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>indet_img_carrier</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">,</span><span> </span><span>intro</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8712; carrier S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">defines</span></span><span> </span><span>Eval_def</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Eval == eval R S h s&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;JE: I have moved the following lemma from Ring.thy and lifted then to the locale \&lt;^term&gt;&#8249;ring_hom_ring&#8250; from \&lt;^term&gt;&#8249;ring_hom_cring&#8250;.&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;JE: I was considering using it in &#8249;eval_ring_hom&#8250;, but that property does not hold for non commutative rings, so
  maybe it is not that necessary.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>ring_hom_ring</span><span class="delimiter">)</span><span> </span><span>hom_finsum</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; A &#8594; carrier R &#10233;
  h (finsum R f A) = finsum S (h &#8728; f) A&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>A</span><span> </span><span>rule</span><span class="delimiter">:</span><span> </span><span>infinite_finite_induct</span><span class="delimiter">,</span><span> </span><span>auto</span><span> </span><span>simp</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_pre_univ_prop</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>eval_ring_hom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>S</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8712; carrier S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s &#8712; ring_hom P S&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>ring_hom_memI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>p</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s p &#8712; carrier S&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>eval_on_carrier</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>S</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>p</span><span> </span><span>q</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) = eval R S h s p &#8853;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> eval R S h s q&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>eval_on_carrier</span><span> </span><span>P.a_closed</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>S</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>S <span class="hidden">&#8665;</span></sub>i&#8712;{..deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)}. h (coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) =
      (&#10753;<span class="hidden">&#8664;</span><sub>S <span class="hidden">&#8665;</span></sub>i&#8712;{..deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)} &#8746; {deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)&lt;..max (deg R p) (deg R q)}.
        h (coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>S.finsum_cong</span><span>
</span><span>        </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>S.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>coeff_add</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
        (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..max (deg R p) (deg R q)}.
          h (coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>i&#8712;{..max (deg R p) (deg R q)}. h (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) &#8853;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>i&#8712;{..max (deg R p) (deg R q)}. h (coeff P q i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>S.finsum_cong</span><span>
</span><span>        </span><span>add</span><span class="delimiter">:</span><span> </span><span>S.l_distr</span><span> </span><span>deg_aboveD</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
        (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p} &#8746; {deg R p&lt;..max (deg R p) (deg R q)}.
          h (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) &#8853;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
        (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R q} &#8746; {deg R q&lt;..max (deg R p) (deg R q)}.
          h (coeff P q i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span> </span><span>max.cobounded1</span><span> </span><span>max.cobounded2</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. h (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) &#8853;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R q}. h (coeff P q i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>S.finsum_cong</span><span>
</span><span>        </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>S.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>i &#8712; {..deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)}. h (coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>i &#8712; {..deg R p}. h (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) &#8853;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>i &#8712; {..deg R q}. h (coeff P q i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s &#120813;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> = &#120813;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>eval_on_carrier</span><span> </span><span>UP_one_closed</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>p</span><span> </span><span>q</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) = eval R S h s p &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> eval R S h s q&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>eval_on_carrier</span><span> </span><span>UP_mult_closed</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)}. h (coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)} &#8746; {deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)&lt;..deg R p + deg R q}.
        h (coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>S.finsum_cong</span><span>
</span><span>        </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>S.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span>
</span><span>        </span><span>del</span><span class="delimiter">:</span><span> </span><span>coeff_mult</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p + deg R q}. h (coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span> </span><span>deg_mult_ring</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p + deg R q}.
         &#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> k &#8712; {..i}.
           h (coeff P p k) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> h (coeff P q (i - k)) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
           (s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> k &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> (i - k)))&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>S.finsum_cong</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>S.nat_pow_mult</span><span> </span><span>Pi_def</span><span>
</span><span>        </span><span>S.m_ac</span><span> </span><span>S.finsum_rdistr</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i&#8712;{..deg R p}. h (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i&#8712;{..deg R q}. h (coeff P q i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>S.cauchy_product</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span> </span><span>bound.intro</span><span> </span><span>deg_aboveD</span><span> </span><span>S.m_ac</span><span>
</span><span>        </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q)}. h (coeff P (p &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) =
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R p}. h (coeff P p i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>
      (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R q}. h (coeff P q i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  The following lemma could be proved in &#8249;UP_cring&#8250; with the additional
  assumption that &#8249;h&#8250; is closed.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_pre_univ_prop</span><span class="delimiter">)</span><span> </span><span>eval_const</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| s &#8712; carrier S; r &#8712; carrier R |] ==&gt; eval R S h s (monom P r 0) = h r&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>eval_on_carrier</span><span> </span><span>monom_closed</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Further properties of the evaluation homomorphism.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The following proof is complicated by the fact that in arbitrary
  rings one might have \&lt;^term&gt;&#8249;one R = zero R&#8250;.&#8250;</span></span></span><span>
</span><span>
</span><span class="comment"><span class="delete"><span class="delete"><span class="delete"><span class="delete">(* TODO: simplify by cases &quot;one R = zero R&quot; *)</span></span></span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_pre_univ_prop</span><span class="delimiter">)</span><span> </span><span>eval_monom1</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>S</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8712; carrier S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s (monom P &#120813; 1) = s&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>eval_on_carrier</span><span> </span><span>monom_closed</span><span> </span><span>R.one_closed</span><span class="delimiter">)</span><span>
</span><span>   </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>S</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i&#8712;{..deg R (monom P &#120813; 1)}. h (coeff P (monom P &#120813; 1) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) =
    (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i&#8712;{..deg R (monom P &#120813; 1)} &#8746; {deg R (monom P &#120813; 1)&lt;..1}.
      h (coeff P (monom P &#120813; 1) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>cong</span><span class="delimiter">:</span><span> </span><span>S.finsum_cong</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>coeff_monom</span><span>
</span><span>      </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_aboveD</span><span> </span><span>S.finsum_Un_disjoint</span><span> </span><span>ivl_disj_int_one</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
    (&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..1}. h (coeff P (monom P &#120813; 1) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>only</span><span class="delimiter">:</span><span> </span><span>ivl_disj_un_one</span><span> </span><span>deg_monom_le</span><span> </span><span>R.one_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = s&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s = &#120812;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>S</span><span> </span><span>Pi_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i &#8712; {..deg R (monom P &#120813; 1)}.
    h (coeff P (monom P &#120813; 1) i) &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> i) = s&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Interpretation of ring homomorphism lemmas.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">sublocale</span></span><span> </span><span>UP_univ_prop</span><span> </span><span class="delimiter">&lt;</span><span> </span><span>ring_hom_cring</span><span> </span><span>P</span><span> </span><span>S</span><span> </span><span>Eval</span><span>
</span><span>  </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Eval_def</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>eval_ring_hom</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_cring</span><span class="delimiter">)</span><span> </span><span>monom_pow</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(monom P a n) [^]<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> m = monom P (a [^] m) (n * m)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>m</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Suc</span><span> </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>R</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>monom_mult</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>monom_mult</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span> </span><span>add.commute</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>ring_hom_cring</span><span class="delimiter">)</span><span> </span><span>hom_pow</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;x &#8712; carrier R ==&gt; h (x [^] n) = h x [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> (n::nat)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>n</span><span class="delimiter">)</span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_univ_prop</span><span class="delimiter">)</span><span> </span><span>Eval_monom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier R ==&gt; Eval (monom P r n) = h r &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> n&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Eval (monom P r n) = Eval (monom P r 0 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (monom P &#120813; 1) [^]<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> n)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>monom_mult</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>monom_mult</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span> </span><span>monom_pow</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span> </span><span>eval_monom1</span><span> </span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>s</span><span> </span><span class="delimiter">=</span><span> </span><span>s</span><span class="delimiter">,</span><span> </span><span>folded</span><span> </span><span>Eval_def</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = h r &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> n&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>eval_const</span><span> </span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>s</span><span> </span><span class="delimiter">=</span><span> </span><span>s</span><span class="delimiter">,</span><span> </span><span>folded</span><span> </span><span>Eval_def</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_pre_univ_prop</span><span class="delimiter">)</span><span> </span><span>eval_monom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>S</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8712; carrier S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s (monom P r n) = h r &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> s [^]<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> n&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>UP_univ_prop</span><span> </span><span>R</span><span> </span><span>S</span><span> </span><span>h</span><span> </span><span>P</span><span> </span><span>s</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R S h s&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UP_pre_univ_prop_axioms</span><span> </span><span>P_def</span><span> </span><span>R</span><span> </span><span>S</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>UP_univ_prop.intro</span><span> </span><span>UP_univ_prop_axioms.intro</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>R</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Eval_monom</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">in</span></span><span> </span><span>UP_univ_prop</span><span class="delimiter">)</span><span> </span><span>Eval_smult</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;[| r &#8712; carrier R; p &#8712; carrier P |] ==&gt; Eval (r &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) = h r &#8855;<span class="hidden">&#8664;</span><sub>S<span class="hidden">&#8665;</span></sub> Eval p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>monom_mult_is_smult</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span>
</span><span>      </span><span>eval_const</span><span> </span><span class="delimiter">[</span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>s</span><span> </span><span class="delimiter">=</span><span> </span><span>s</span><span class="delimiter">,</span><span> </span><span>folded</span><span> </span><span>Eval_def</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ring_hom_cringI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cring R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cring S&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;h &#8712; ring_hom R S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ring_hom_cring R S h&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>ring_hom_cring.intro</span><span> </span><span>ring_hom_cring_axioms.intro</span><span>
</span><span>    </span><span>cring.axioms</span><span> </span><span>assms</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_pre_univ_prop</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_hom_unique</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ring_hom_cring P S Phi&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>Phi</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Phi (monom P &#120813; (Suc 0)) = s&quot;</span></span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;!!r. r &#8712; carrier R ==&gt; Phi (monom P r 0) = h r&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ring_hom_cring P S Psi&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>Psi</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Psi (monom P &#120813; (Suc 0)) = s&quot;</span></span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;!!r. r &#8712; carrier R ==&gt; Psi (monom P r 0) = h r&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>S</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8712; carrier S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Phi p = Psi p&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>ring_hom_cring</span><span> </span><span>P</span><span> </span><span>S</span><span> </span><span>Phi</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>ring_hom_cring</span><span> </span><span>P</span><span> </span><span>S</span><span> </span><span>Psi</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fact</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Phi p =
      Phi (&#10753;<span class="hidden">&#8664;</span><sub>P <span class="hidden">&#8665;</span></sub>i &#8712; {..deg R p}. monom P (coeff P p i) 0 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1 [^]<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>up_repr</span><span> </span><span>P</span><span> </span><span>monom_mult</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span> </span><span>monom_pow</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>monom_mult</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... =
      Psi (&#10753;<span class="hidden">&#8664;</span><sub>P <span class="hidden">&#8665;</span></sub>i&#8712;{..deg R p}. monom P (coeff P p i) 0 &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P &#120813; 1 [^]<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> i)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>Phi</span><span> </span><span>Psi</span><span> </span><span>P</span><span> </span><span>Pi_def</span><span> </span><span>comp_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;... = Psi p&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>up_repr</span><span> </span><span>P</span><span> </span><span>monom_mult</span><span> </span><span class="delimiter">[</span><span>THEN</span><span> </span><span>sym</span><span class="delimiter">]</span><span> </span><span>monom_pow</span><span> </span><span>del</span><span class="delimiter">:</span><span> </span><span>monom_mult</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>ring_homD</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>Phi</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Phi &#8712; ring_hom P S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;ring_hom_cring P S Phi&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>Phi</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>UP_universal_property</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>S</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;s &#8712; carrier S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;!Phi. Phi &#8712; ring_hom P S &#8745; extensional (carrier P) &#8743;
    Phi (monom P &#120813; 1) = s &#8743;
    (&#8704;r &#8712; carrier R. Phi (monom P r 0) = h r)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>S</span><span> </span><span>eval_monom1</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>eval_ring_hom</span><span> </span><span>eval_const</span><span> </span><span>eval_extensional</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>extensionalityI</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>UP_hom_unique</span><span> </span><span>ring_homD</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;JE: The following lemma was added by me; it might be even lifted to a simpler locale&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>monoid</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>nat_pow_eone</span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>x_in_G</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x &#8712; carrier G&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;x [^] (1::nat) = x&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>nat_pow_Suc</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>x</span><span> </span><span>0</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>nat_pow_0</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>x</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>l_one</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>x_in_G</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_ring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">abbreviation</span></span><span> </span><span>lcoeff</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(nat =&gt;&#39;a) =&gt; &#39;a&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff p == coeff P p (deg R p)&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lcoeff_nonzero2</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p_in_R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>p_not_zero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff p &#8800; &#120812;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>lcoeff_nonzero</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>p_not_zero</span><span> </span><span>p_in_R</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The long division algorithm: some previous facts.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_minus</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>q</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) n = coeff P p n &#8854; coeff P q n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a_minus_def</span><span> </span><span>p</span><span> </span><span>q</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lcoeff_closed</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff p &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>p</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_smult_decr</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a_in_R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>f_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (a &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f) &#8804; deg R f&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_smult_ring</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span> </span><span>f_in_P</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a = &#120812;&quot;</span></span></span><span class="delimiter">,</span><span> </span><span>auto</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>coeff_monom_mult</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;c &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P c n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) (m + n) = c &#8855; (coeff P p m)&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (monom P c n &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> p) (m + n) = (&#10753;i&#8712;{..m + n}. (if n = i then c else &#120812;) &#8855; coeff P p (m + n - i))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span> </span><span>P</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;m + n&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>n</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#10753;i&#8712;{..m + n}. (if n = i then c else &#120812;) &#8855; coeff P p (m + n - i)) =
    (&#10753;i&#8712;{..m + n}. (if n = i then c &#8855; coeff P p (m + n - i) else &#120812;))&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>R.finsum_cong</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..m + n}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..m + n}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i::nat. (if n = i then c else &#120812;) &#8855; coeff P p (m + n - i))&quot;</span></span></span><span>
</span><span>      </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i::nat. (if n = i then c &#8855; coeff P p (m + n - i) else &#120812;))&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>P</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span>simp_implies_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = c &#8855; coeff P p m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_singleton</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>n</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..m + n}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. c &#8855; coeff P p (m + n - i))&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>P</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>P</span><span> </span><span>R</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_lcoeff_cancel</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>p_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>q_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>r_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_r_nonzero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r &#8800; 0&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_R_p</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &#8804; deg R r&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_R_q</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R q &#8804; deg R r&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>coeff_R_p_eq_q</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P p (deg R r) = &#8854;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> (coeff P q (deg R r))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &lt; deg R r&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_le</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8804; deg R r&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>deg_r_le</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r &lt; m&quot;</span></span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) m = &#120812;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>slp</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &lt; m&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R q &lt; m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_R_p</span><span> </span><span>deg_R_q</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_r_le</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>max_sl</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;max (deg R p) (deg R q) &lt; m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &lt; m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_add</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>p_in_P</span><span> </span><span>q_in_P</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>arith</span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>deg_R_p</span><span> </span><span>deg_R_q</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_add</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>p_in_P</span><span> </span><span>q_in_P</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span>
</span><span>        </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_aboveD</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&quot;</span></span></span><span> </span><span>m</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p_in_P</span><span> </span><span>q_in_P</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>p_in_P</span><span> </span><span>q_in_P</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_ne</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8800; deg R r&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>ccontr</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>nz</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#172; deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) &#8800; deg R r&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) = deg R r&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>deg_r_nonzero</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>r_nonzero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span class="delimiter">,</span><span> </span><span>simp_all</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q) (deg R r) = &#120812;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_add</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>p_in_P</span><span> </span><span>q_in_P</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_R_p_eq_q</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>p_in_P</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r&quot;</span></span></span><span class="delimiter">]</span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>q_in_P</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>algebra</span><span>
</span><span>    </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>lcoeff_nonzero</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>r_nonzero</span><span> </span><span>r_in_P</span><span class="delimiter">]</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_eq</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>lcoeff_nonzero</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>p_in_P</span><span> </span><span>q_in_P</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_r_nonzero</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span class="delimiter">,</span><span> </span><span>auto</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>monom_deg_mult</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>f_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>g_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_le</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R g &#8804; deg R f&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>a_in_R</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a (deg R f - deg R g)) &#8804; deg R f&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_mult_ring</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>g_in_P</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f - deg R g&quot;</span></span></span><span class="delimiter">]</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a = &#120812;&quot;</span></span></span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>g_in_P</span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>_</span><span> </span><span>a_in_R</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f - deg R g&quot;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_le</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_zero_impl_monom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>f_in_P</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_f</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f = 0&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f = monom P (coeff P f 0) 0&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>up_eqI</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f_in_P</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span> </span><span>0</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f_in_P</span><span> </span><span>deg_f</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_aboveD</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>f</span><span> </span><span>_</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The long division proof for commutative rings&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_cring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>exI3</span><span class="delimiter">:</span><span> </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>exist</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Pred x y z&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707; x y z. Pred x y z&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exist</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Jacobson&#39;s Theorem 2.14&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>long_div_theorem</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>g_in_P</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>f_in_P</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>g_not_zero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;q r (k::nat). (q &#8712; carrier P) &#8743; (r &#8712; carrier P) &#8743; (lcoeff g)[^]<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>k &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f = g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r &#8743; (r = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; deg R r &lt; deg R g)&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f_in_P</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f&quot;</span></span></span><span> </span><span>arbitrary</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f&quot;</span></span></span><span> </span><span>rule</span><span class="delimiter">:</span><span> </span><span>nat_less_induct</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>1</span><span> </span><span>f</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>f_in_P</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1.prems&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?pred</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955; q r (k::nat).
    (q &#8712; carrier P) &#8743; (r &#8712; carrier P)
    &#8743; (lcoeff g)[^]<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub>k &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f = g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r &#8743; (r = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; deg R r &lt; deg R g))&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?lg</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff g&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="var">?lf</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff f&quot;</span></span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f &lt; deg R g&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?pred &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_g_le_deg_f</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R g &#8804; deg R f&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?k</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1::nat&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?f1</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (monom P (?lf) (deg R f - deg R g))) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (?lg &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?q</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P (?lf) (deg R f - deg R g)&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>f1_in_carrier</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?f1 &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>q_in_carrier</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp_all</span><span>
</span><span>      </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f = 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>        </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_g</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R g = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>True</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_g_le_deg_f</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?pred f &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> 1&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_zero_impl_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>g_in_P</span><span> </span><span>deg_g</span><span class="delimiter">]</span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sym</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>monom_mult_is_smult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>coeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>g_in_P</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span class="delimiter">]</span><span> </span><span>f_in_P</span><span class="delimiter">]</span><span class="delimiter">]</span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_g</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>        </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">note</span></span><span> </span><span>deg_f_nzero</span><span> </span><span class="delimiter">=</span><span> </span><span>False</span><span>
</span><span>        </span><span class="keyword1"><span class="command">{</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>exist</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff g [^] ?k &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f = g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?f1&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>minus_add</span><span> </span><span>r_neg</span><span> </span><span>sym</span><span> </span><span class="delimiter">[</span><span>
</span><span>              </span><span>OF</span><span> </span><span>a_assoc</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q)&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff g &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f&quot;</span></span></span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_remainder_l_f</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?f1) &lt; deg R f&quot;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>deg_uminus</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f1_in_carrier</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?f1 &lt; deg R f&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_lcoeff_cancel</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (?lg &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f)) &#8804; deg R f&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_smult_ring</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="var">?lg</span><span> </span><span>f</span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>lcoeff_nonzero2</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>g_in_P</span><span> </span><span>g_not_zero</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q) &#8804; deg R f&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>monom_deg_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f_in_P</span><span> </span><span>g_in_P</span><span> </span><span>deg_g_le_deg_f</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="var">?lf</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q) (deg R f) = &#8854; coeff P (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (?lg &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f)) (deg R f)&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>g_in_P</span><span> </span><span>monom_closed</span><span>
</span><span>                  </span><span class="delimiter">[</span><span>OF</span><span> </span><span>lcoeff_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f_in_P</span><span class="delimiter">]</span><span class="delimiter">,</span><span>
</span><span>                    </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f - deg R g&quot;</span></span></span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R f&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>lcoeff_closed</span><span>
</span><span>                  </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f_in_P</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(deg R f - deg R g)&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_cong&#39;</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..deg R f}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{..deg R f}&quot;</span></span></span><span>
</span><span>                  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. coeff P g i &#8855; (if deg R f - deg R g = deg R f - i then ?lf else &#120812;))&quot;</span></span></span><span>
</span><span>                  </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. if deg R g = i then coeff P g i &#8855; ?lf else &#120812;)&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.finsum_singleton</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R g&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;{.. deg R f}&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(&#955;i. coeff P g i &#8855; ?lf)&quot;</span></span></span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_g_le_deg_f</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>            </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>deg_f_nzero</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>q&#39;</span><span> </span><span>r&#39;</span><span> </span><span>k&#39;</span><span>
</span><span>            </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>rem_desc</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?lg [^] (k&#39;::nat) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?f1) = g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39; &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;&quot;</span></span></span><span>
</span><span>            </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>rem_deg</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(r&#39; = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; deg R r&#39; &lt; deg R g)&quot;</span></span></span><span>
</span><span>            </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>q&#39;_in_carrier</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q&#39; &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>r&#39;_in_carrier</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r&#39; &#8712; carrier P&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1.hyps&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>f1_in_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>exI3</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span>_</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;((?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39;)&quot;</span></span></span><span> </span><span>r&#39;</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;Suc k&#39;&quot;</span></span></span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>intro</span><span> </span><span>conjI</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(?lg [^] (Suc k&#39;)) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f = g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ((?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39;) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;&quot;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>              </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(?lg [^] (Suc k&#39;)) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f = (?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?f1)&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smult_assoc1</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>_</span><span> </span><span>_</span><span> </span><span>f_in_P</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>exist</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = (?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ((?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ( &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?f1))&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>UP_smult_r_distr</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = (?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39; &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;)&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>rem_desc</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = (?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39; &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sym</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a_assoc</span><span> </span><span class="delimiter">[</span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;?lg [^] k&#39; &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q)&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39;&quot;</span></span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r&#39;&quot;</span></span></span><span class="delimiter">]</span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>r&#39;_in_carrier</span><span> </span><span>q&#39;_in_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = (?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> (?q &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> g) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39; &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> g &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>q&#39;_in_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>m_comm</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = (((?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> g) &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39; &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> g &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smult_assoc2</span><span> </span><span>q&#39;_in_carrier</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1.prems&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = ((?lg [^] k&#39;) &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> ?q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q&#39;) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> g &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&#39;&quot;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>sym</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>l_distr</span><span class="delimiter">]</span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>q&#39;_in_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>              </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>m_comm</span><span> </span><span>q&#39;_in_carrier</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>            </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>rem_deg</span><span> </span><span>q&#39;_in_carrier</span><span> </span><span>r&#39;_in_carrier</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;The remainder theorem as corollary of the long division theorem.&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">context</span></span><span> </span><span>UP_cring</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_minus_monom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R_not_trivial</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(carrier R &#8800; {&#120812;})&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) = 1&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?g = 1&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?g &#8804; 1&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span>
</span><span>    </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(1::nat) &lt; m&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P ?g m = &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_minus</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span>algebra</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?g &#8805; 1&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P ?g 1 &#8800; &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.carrier_one_not_zero</span><span> </span><span>R_not_trivial</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> </span><span>algebra</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>lcoeff_monom</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R_not_trivial</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;(carrier R &#8800; {&#120812;})&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;lcoeff (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) = &#120813;&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_minus_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span> </span><span>R_not_trivial</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_minus</span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span>algebra</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_nzero_nzero</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>deg_p_nzero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R p &#8800; 0&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;p &#8800; &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub>&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_zero</span><span> </span><span>deg_p_nzero</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>deg_monom_minus</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R_not_trivial</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;carrier R &#8800; {&#120812;}&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) = 1&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?g = 1&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?g &#8804; 1&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_aboveI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span class="delimiter">::</span><span>nat</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1 &lt; m&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P ?g m = &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_minus</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span class="delimiter">]</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>m</span><span class="delimiter">]</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span> </span><span>m</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span> </span><span>m</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span>algebra</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;1 &#8804; deg R ?g&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>deg_belowI</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P ?g 1 &#8800; &#120812;&quot;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_minus</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span class="delimiter">]</span><span> </span><span>monom_closed</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span class="delimiter">]</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span class="delimiter">]</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span> </span><span>1</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>coeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span> </span><span>1</span><span class="delimiter">]</span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R_not_trivial</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>R.carrier_one_not_zero</span><span>
</span><span>      </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span> </span><span>algebra</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>eval_monom_expr</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) = &#120812;&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a ?g = _&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>UP_pre_univ_prop</span><span> </span><span>R</span><span> </span><span>R</span><span> </span><span>id</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>eval_ring_hom</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a &#8712; ring_hom P R&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>eval_ring_hom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>ring_hom_cring</span><span> </span><span>P</span><span> </span><span>R</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>unfold_locales</span><span> </span><span class="delimiter">(</span><span>rule</span><span> </span><span>eval_ring_hom</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>mon1_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8712; carrier P&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>mon0_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P a 0 &#8712; carrier P&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>min_mon0_closed</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0 &#8712; carrier P&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span>R.a_inv_closed</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a ?g = eval R R id a (monom P &#120813; 1) &#8854; eval R R id a (monom P a 0)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>a_minus_def</span><span> </span><span>mon0_closed</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = a &#8854; a&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>eval_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>R.one_closed</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>1</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>eval_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>0</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = &#120812;&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>algebra</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>remainder_theorem_exist</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>f</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>a</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R_not_trivial</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;carrier R &#8800; {&#120812;}&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707; q r. (q &#8712; carrier P) &#8743; (r &#8712; carrier P) &#8743; f = (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r &#8743; (deg R r = 0)&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707; q r. (q &#8712; carrier P) &#8743; (r &#8712; carrier P) &#8743; f = ?g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r &#8743; (deg R r = 0)&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">let</span></span><span> </span><span class="var">?g</span><span> </span><span class="delimiter">=</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>deg_minus_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span> </span><span>R_not_trivial</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>deg_g_nzero</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R ?g &#8800; 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707;q r (k::nat). q &#8712; carrier P &#8743; r &#8712; carrier P &#8743;
    lcoeff ?g [^] k &#8857;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> f = ?g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r &#8743; (r = &#120812;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> &#8744; deg R r &lt; deg R ?g)&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>long_div_theorem</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>_</span><span> </span><span>f</span><span> </span><span>deg_nzero_nzero</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>deg_g_nzero</span><span class="delimiter">]</span><span class="delimiter">]</span><span> </span><span>a</span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>lcoeff_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span> </span><span>R_not_trivial</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>deg_monom_minus</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span> </span><span>R_not_trivial</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>smult_one</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>deg_zero</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>remainder_theorem_expression</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>f</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>a</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>q</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>r</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r &#8712; carrier P&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R_not_trivial</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;carrier R &#8800; {&#120812;}&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>f_expr</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f = (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f = ?g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f = ?gq &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_r_0</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r = 0&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = monom P (eval R R id a f) 0&quot;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">interpret</span></span><span> </span><span>UP_pre_univ_prop</span><span> </span><span>R</span><span> </span><span>R</span><span> </span><span>id</span><span> </span><span>P</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>standard</span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>eval_ring_hom</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a &#8712; ring_hom P R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>eval_ring_hom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a f = eval R R id a ?gq &#8853;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> eval R R id a r&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>f_expr</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ring_hom_add</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>eval_ring_hom</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = ((eval R R id a ?g) &#8855; (eval R R id a q)) &#8853;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> eval R R id a r&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ring_hom_mult</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>eval_ring_hom</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = &#120812; &#8853; eval R R id a r&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>eval_monom_expr</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>eval_ring_hom</span><span>
</span><span>    </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>ring_hom_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>q</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8230; = eval R R id a r&quot;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>eval_ring_hom</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>ring_hom_def</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>r</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>Pi_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>eval_eq</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval R R id a f = eval R R id a r&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>deg_zero_impl_monom</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>r</span><span> </span><span>deg_r_0</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;r = monom P (coeff P r 0) 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>eval_const</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>a</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;coeff P r 0&quot;</span></span></span><span class="delimiter">]</span><span> </span><span>eval_eq</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">corollary</span></span><span> </span><span>remainder_theorem</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span>f</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;f &#8712; carrier P&quot;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>a</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;a &#8712; carrier R&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>R_not_trivial</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;carrier R &#8800; {&#120812;}&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707; q r. (q &#8712; carrier P) &#8743; (r &#8712; carrier P) &#8743;
     f = (monom P &#120813;<span class="hidden">&#8664;</span><sub>R<span class="hidden">&#8665;</span></sub> 1 &#8854;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P a 0) &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P (eval R R id a f) 0&quot;</span></span></span><span>
</span><span>  </span><span class="delimiter">(</span><span class="keyword2"><span class="keyword">is</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;&#8707; q r. (q &#8712; carrier P) &#8743; (r &#8712; carrier P) &#8743; f = ?g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> monom P (eval R R id a f) 0&quot;</span></span></span><span class="delimiter">)</span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>remainder_theorem_exist</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f</span><span> </span><span>a</span><span> </span><span>R_not_trivial</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>q</span><span> </span><span>r</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>q_r</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;q &#8712; carrier P &#8743; r &#8712; carrier P &#8743; f = ?g &#8855;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> q &#8853;<span class="hidden">&#8664;</span><sub>P<span class="hidden">&#8665;</span></sub> r&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>deg_r</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;deg R r = 0&quot;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>force</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>remainder_theorem_expression</span><span> </span><span class="delimiter">[</span><span>OF</span><span> </span><span>f</span><span> </span><span>a</span><span> </span><span>_</span><span> </span><span>_</span><span> </span><span>R_not_trivial</span><span class="delimiter">,</span><span> </span><span>of</span><span> </span><span>q</span><span> </span><span>r</span><span class="delimiter">]</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span><span>
</span><span>
</span><span class="keyword1"><span class="command">subsection</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Sample Application of Evaluation Homomorphism&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>UP_pre_univ_propI</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cring R&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cring S&quot;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;h &#8712; ring_hom R S&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;UP_pre_univ_prop R S h&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>assms</span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>UP_pre_univ_prop.intro</span><span> </span><span>ring_hom_cring.intro</span><span>
</span><span>    </span><span>ring_hom_cring_axioms.intro</span><span> </span><span>UP_cring.intro</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">definition</span></span><span>
</span><span>  </span><span>INTEG</span><span> </span><span class="delimiter">::</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;int ring&quot;</span></span></span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;INTEG = &#10631;carrier = UNIV, mult = (*), one = 1, zero = 0, add = (+)&#10632;&quot;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>INTEG_cring</span><span class="delimiter">:</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;cring INTEG&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>INTEG_def</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>intro</span><span class="delimiter">!</span><span class="delimiter">:</span><span> </span><span>cringI</span><span> </span><span>abelian_groupI</span><span> </span><span>comm_monoidI</span><span>
</span><span>    </span><span>left_minus</span><span> </span><span>distrib_right</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>INTEG_id_eval</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;UP_pre_univ_prop INTEG INTEG id&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>fast</span><span> </span><span>intro</span><span class="delimiter">:</span><span> </span><span>UP_pre_univ_propI</span><span> </span><span>INTEG_cring</span><span> </span><span>id_ring_hom</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Interpretation now enables to import all theorems and lemmas
  valid in the context of homomorphisms between \&lt;^term&gt;&#8249;INTEG&#8250; and \&lt;^term&gt;&#8249;UP INTEG&#8250; globally.
&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">interpretation</span></span><span> </span><span>INTEG</span><span class="delimiter">:</span><span> </span><span>UP_pre_univ_prop</span><span> </span><span>INTEG</span><span> </span><span>INTEG</span><span> </span><span>id</span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;UP INTEG&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>INTEG_id_eval</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp_all</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>INTEG_closed</span><span> </span><span class="delimiter">[</span><span>intro</span><span class="delimiter">,</span><span> </span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;z &#8712; carrier INTEG&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>INTEG_def</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>INTEG_mult</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;mult INTEG z w = z * w&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>unfold</span><span> </span><span>INTEG_def</span><span class="delimiter">)</span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>INTEG_pow</span><span> </span><span class="delimiter">[</span><span>simp</span><span class="delimiter">]</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="string"><span class="delete"><span class="delete">&quot;pow INTEG z n = z ^ n&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>induct</span><span> </span><span>n</span><span class="delimiter">)</span><span> </span><span class="delimiter">(</span><span>simp_all</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>INTEG_def</span><span> </span><span>nat_pow_def</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span class="string"><span class="delete"><span class="delete">&quot;eval INTEG INTEG id 10 (monom (UP INTEG) 5 2) = 500&quot;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>INTEG.eval_monom</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>

</div>
</body>
</html>
